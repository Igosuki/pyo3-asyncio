<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `pyo3_asyncio` crate."><meta name="keywords" content="rust, rustlang, rust-lang, pyo3_asyncio"><title>pyo3_asyncio - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../pyo3_asyncio/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate pyo3_asyncio</p><div class="block version"><p>Version 0.1.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all pyo3_asyncio's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#functions">Functions</a></li></ul></div><p class="location"></p><script>window.sidebarCurrent = {name: "pyo3_asyncio", ty: "mod", relpath: "../"};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/pyo3_asyncio/lib.rs.html#1-343" title="goto source code">[src]</a></span><span class="in-band">Crate <a class="mod" href="">pyo3_asyncio</a></span></h1><div class="docblock"><p>Rust Bindings to the Python Asyncio Event Loop</p>
<h1 id="motivation" class="section-header"><a href="#motivation">Motivation</a></h1>
<p>This crate aims to provide a convenient interface to manage the interop between Python and
Rust's async/await models. It supports conversions between Rust and Python futures and manages
the event loops for both languages. Python's threading model and GIL can make this interop a bit
trickier than one might expect, so there are a few caveats that users should be aware of.</p>
<h2 id="why-two-event-loops" class="section-header"><a href="#why-two-event-loops">Why Two Event Loops</a></h2>
<p>Currently, we don't have a way to run Rust futures directly on Python's event loop. Likewise,
Python's coroutines cannot be directly spawned on a Rust event loop. The two coroutine models
require some additional assistance from their event loops, so in all likelihood they will need
a new <em>unique</em> event loop that addresses the needs of both languages if the coroutines are to
be run on the same event loop.</p>
<p>It's not immediately clear that this would provide worthwhile performance wins either, so in the
interest of keeping things simple, this crate runs both event loops independently and handles
the communication between them.</p>
<h2 id="pythons-event-loop" class="section-header"><a href="#pythons-event-loop">Python's Event Loop</a></h2>
<p>Python is very picky about the threads used by the <code>asyncio</code> executor. In particular, it needs
to have control over the main thread in order to handle signals like CTRL-C correctly. This
means that Cargo's default test harness will no longer work since it doesn't provide a method of
overriding the main function to add our event loop initialization and finalization.</p>
<h2 id="rusts-event-loop" class="section-header"><a href="#rusts-event-loop">Rust's Event Loop</a></h2>
<p>Currently only the Tokio runtime is supported by this crate. Tokio makes it easy to construct
and maintain a runtime that runs on background threads only and it provides a single threaded
scheduler to make it easier to work around Python's GIL.</p>
<blockquote>
<p><em>In the future, more runtimes may be supported for Rust.</em></p>
</blockquote>
<h2 id="features" class="section-header"><a href="#features">Features</a></h2>
<p>Items marked with
<span
  class="module-item stab portability"
  style="display: inline; border-radius: 3px; padding: 2px; font-size: 80%; line-height: 1.2;"
><code>testing</code></span>
are only available when the <code>testing</code> Cargo feature is enabled:</p>
<pre><code class="language-toml">[dependencies.pyo3-asyncio]
version = &quot;0.1.0&quot;
features = [&quot;testing&quot;]
</code></pre>
</div><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="testing/index.html" title="pyo3_asyncio::testing mod">testing</a></td><td class="docblock-short"><p><span class="module-item stab portability" style="display: inline; border-radius: 3px; padding: 2px; font-size: 80%; line-height: 1.2;"><code>testing</code></span> Utilities for writing PyO3 Asyncio tests</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.get_event_loop.html" title="pyo3_asyncio::get_event_loop fn">get_event_loop</a></td><td class="docblock-short"><p>Get a reference to the Python Event Loop from Rust</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.into_coroutine.html" title="pyo3_asyncio::into_coroutine fn">into_coroutine</a></td><td class="docblock-short"><p>Convert a Rust Future into a Python coroutine</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.into_future.html" title="pyo3_asyncio::into_future fn">into_future</a></td><td class="docblock-short"><p>Convert a Python coroutine into a Rust Future</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.run_forever.html" title="pyo3_asyncio::run_forever fn">run_forever</a></td><td class="docblock-short"><p>Run the event loop forever</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.run_until_complete.html" title="pyo3_asyncio::run_until_complete fn">run_until_complete</a></td><td class="docblock-short"><p>Run the event loop until the given Future completes</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.spawn.html" title="pyo3_asyncio::spawn fn">spawn</a></td><td class="docblock-short"><p>Spawn a Future onto the executor</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.spawn_blocking.html" title="pyo3_asyncio::spawn_blocking fn">spawn_blocking</a></td><td class="docblock-short"><p>Spawn a blocking task onto the executor</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.with_runtime.html" title="pyo3_asyncio::with_runtime fn">with_runtime</a></td><td class="docblock-short"><p>Wraps the provided function with the initialization and finalization for PyO3 Asyncio</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "pyo3_asyncio";</script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>